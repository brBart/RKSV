<LoadDialog>:
	BoxLayout:
		size: root.size
		pos: root.pos
		orientation: "vertical"
		FileChooserListView:
			id: filechooser
		BoxLayout:
			size_hint_y: None
			Button:
				text: "Cancel"
				on_release: root.cancel()
			Button:
				text: "Load"
				on_release: root.load(filechooser.path, filechooser.selection)

<SaveDialog>:
	text_input: text_input
	BoxLayout:
		size: root.size
		pos: root.pos
		orientation: "vertical"
		FileChooserListView:
			id: filechooser
			on_selection: text_input.text = self.selection and self.selection[0] or ''
		TextInput:
			id: text_input
			size_hint_y: None
			multiline: False
		BoxLayout:
			size_hint_y: None
			Button:
				text: "Cancel"
				on_release: root.cancel()
			Button:
				text: "Save"
				on_release: root.save(filechooser.path, text_input.text)

<SingleValueDialog>:
	text_input: text_input
	BoxLayout:
		size: root.size
		pos: root.pos
		orientation: "vertical"
		TextInput:
			id: text_input
			size_hint_y: None
			multiline: False
		BoxLayout:
			size_hint_y: None
			Button:
				text: "Cancel"
				on_release: root.cancel()
			Button:
				text: "Ok"
				on_release: root.receive_value(text_input.text)

<RadioButton@BoxLayout>:
	text: ''
	state: 'normal'
	group: None
	orientation: 'horizontal'
	size_hint_y: None
	CheckBox:
		size_hint_x: None
		group: self.parent.group
		state: self.parent.state
	Label:
		text_size: self.size
		halign: 'left'
		valign: 'middle'
		text: self.parent.text

<VerifyReceiptWidget@GridLayout>:
	rows: 6
	BoxLayout:
		orientation: 'horizontal'
		TextInput:
			multiline: False
		Button:
			size_hint_x: None
			text: '...'
	RadioButton:
		text: 'JWS string'
		group: 'input_format'
		state: 'down'
	RadioButton:
		text: 'QR code'
		group: 'input_format'
	RadioButton:
		text: 'OCR code'
		group: 'input_format'
	RadioButton:
		text: 'URL'
		group: 'input_format'
	Button:
		text: 'Read & Verify'

<VerifyDEPWidget@BoxLayout>:
	orientation: 'vertical'
	BoxLayout:
		size_hint_y: None
		orientation: 'horizontal'
		Button:
			text: 'Load DEP'
		Button:
			text: 'Load AES Key'
	TextInput:
		size_hint_y: None
		multiline: False
	ScrollView:
		do_scroll_x: False
		TreeView:
			size_hint_y: None
			hide_root: True
			height: self.minimum_height

<KeyStoreWidget>:
	id: ks_w
	orientation: 'vertical'
	treeView: ks_tv
	ScrollView:
		do_scroll_x: False
		TreeView:
			id: ks_tv
			size_hint_y: None
			hide_root: True
			height: self.minimum_height
	BoxLayout:
		size_hint_y: None
		orientation: 'horizontal'
		Button:
			text: 'Import'
			on_press: ks_w.importKeyStore()
		Button:
			text: 'Export'
			on_press: ks_w.exportKeyStore()

<RKToolActionBar@ActionBar>:
	pos_hint: {'top': 1}
	ActionView:
		use_separator: True
		ActionPrevious:
			title: 'Registrierkassen Tool'
		ActionOverflow:
		ActionButton:
			text: 'Exit'
			on_press: app.stop()

<MainWidget>:
	orientation: 'vertical'
	RKToolActionBar:
	TabbedPanel:
		do_default_tab: False
		TabbedPanelItem:
			text: 'Verify Receipt'
			VerifyReceiptWidget:
		TabbedPanelItem:
			text: 'Verify DEP'
			VerifyDEPWidget:
		TabbedPanelItem:
			text: 'Key Store'
			KeyStoreWidget:
